<!DOCTYPE HTML>
<html lang="es"><head>
    <meta charset="UTF-8">
    <title>Reservar - Catedral de San Salvador</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Gael Horta Calzada">
    <meta name="description" content="Reservar en el sistema de Oviedo">
    <meta name="keywords" content="reservar, gestión, confirmar, Oviedo">
    <link rel="stylesheet" href="../estilo/estilo.css">
    <link rel="stylesheet" href="../estilo/layout.css">
    <link rel="icon" href="../multimedia/favicon.ico">
</head>
<body>
<header>
    <h1><a href="../index.html">Oviedo</a></h1>
    <nav>
        <a href="../index.html">Inicio</a>
        <a href="lista.php">Viajes</a>
        <a href="mis_reservas.php">Mis Reservas</a>
        <a href="logout.php">Cerrar Sesión (Gael Calzada)</a>
    </nav>
</header>

<main>
    <h2>Reservar: Catedral de San Salvador</h2>
    
        
    <section>
        <h3>Información del Recurso</h3>
        <p>Descripción: Visita guiada a la histórica Catedral de Oviedo, conocida por su impresionante arquitectura gótica y la Cámara Santa.</p>
        <p>Ubicación: Centro Histórico de Oviedo</p>
        <p>Dirección: Plaza de Alfonso II El Casto, s/n, 33003 Oviedo</p>
        <p>Duración: 1.50 hora(s)</p>
        <p>Precio: €8.50 por persona</p>
        <p>Capacidad máxima: 25 personas</p>
    </section>
    
            <form method="POST" action="">
            <fieldset>
                <legend>Datos de la Reserva</legend>
                
                <label>Horario disponible:</label>
                <select name="horario_id" required="" onchange="calcularPrecio()">
                    <option value="">-- Selecciona un horario --</option>
                                            <option value="1" data-precio="8.50" data-plazas="20">
                            15/06/2025 10:00 - 
                            11:30                            (20 plazas disponibles)
                                                    </option>
                                            <option value="2" data-precio="8.50" data-plazas="25">
                            15/06/2025 16:00 - 
                            17:30                            (25 plazas disponibles)
                                                    </option>
                                            <option value="3" data-precio="8.50" data-plazas="18">
                            16/06/2025 10:00 - 
                            11:30                            (18 plazas disponibles)
                                                    </option>
                                    </select>
                
                <label for="numero_personas">Número de personas:</label>
                <input type="number" id="numero_personas" min="1" max="25" value="1" required="" onchange="calcularPrecio()">
                
                <p>Precio total: €0.00</p>
                
                <input type="submit" value="Confirmar Reserva">
            </fieldset>
        </form>
        
    <p><a href="lista.php">← Volver al catálogo de recursos</a></p>
</main>

<script>
function calcularPrecio() {
    const horarioSelect = document.querySelector('select[name="horario_id"]');
    const numeroPersonas = document.querySelector('input[name="numero_personas"]').value;
    const precioElement = document.querySelector('p:nth-of-type(1)');
    
    if (horarioSelect.value && numeroPersonas) {
        const option = horarioSelect.selectedOptions[0];
        const precio = parseFloat(option.dataset.precio);
        const total = precio * parseInt(numeroPersonas);
        precioElement.innerHTML = `Precio total: €${total.toFixed(2)}`;
        
        // Verificar plazas disponibles
        const plazasDisponibles = parseInt(option.dataset.plazas);
        const numPersonasInput = document.querySelector('input[name="numero_personas"]');
        numPersonasInput.max = plazasDisponibles;
        
        if (parseInt(numeroPersonas) > plazasDisponibles) {
            numPersonasInput.value = plazasDisponibles;
            calcularPrecio();
            alert(`Solo hay ${plazasDisponibles} plazas disponibles para este horario.`);
        }
    } else {
        precioElement.innerHTML = 'Precio total: €0.00';
    }
}
</script>

</body></html>